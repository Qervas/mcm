# 1

## 1.1Word corrected

First, we found the all allowed words for Wordle game as a dictionary. To ensure words correctness, words from the spreadsheet compared with the dictionary repeated.

```python
def check_words_from_file(words_file, dictionary_file):
    with open(words_file, 'r') as f:
        words_list = [line.strip() for line in f.readlines()]

    with open(dictionary_file, 'r') as f:
        dictionary_words = set(f.read().split())

    all_words_found = True

    for i, word in enumerate(words_list):
        if word not in dictionary_words:
            print(f"{word} is not found in the dictionary (index {i}).")
            all_words_found = False

    if all_words_found:
        print("All words are found in the dictionary!")
    else:
        print("At least one word is not found in the dictionary.")

```

## 1.2Data process

## 1.3Curve fit

Matlab code:

* Exponential:

  * ```matlab
    function [fitresult, gof] = createFit(t, people)
    %CREATEFIT(T,PEOPLE)
    %  Create a fit.
    %
    %  Data for 'Number of  reported results' fit:
    %      X Input: t
    %      Y Output: people
    %  Output:
    %      fitresult : a fit object representing the fit.
    %      gof : structure with goodness-of fit info.
    %% Fit: 'Number of  reported results'.
    [xData, yData] = prepareCurveData( t, people );

    % Set up fittype and options.
    ft = fittype( 'exp2' );
    opts = fitoptions( 'Method', 'NonlinearLeastSquares' );
    opts.Display = 'Off';
    opts.StartPoint = [326384.036739909 -0.022822962438302 54680.2058215826 -0.00245441115529711];

    % Fit model to data.
    [fitresult, gof] = fit( xData, yData, ft, opts );

    % Plot fit with data.
    figure( 'Name', 'Number of  reported results' );
    h = plot( fitresult, xData, yData );
    legend( h, 'people vs. t', 'Number of  reported results', 'Location', 'NorthEast', 'Interpreter', 'none' );
    % Label axes
    xlabel( 't', 'Interpreter', 'none' );
    ylabel( 'people', 'Interpreter', 'none' );
    grid on
    ```

    ![img](./images/Exponential_fit_matlab.png)
* Gaussian
* ```matlab
  function [fitresult, gof] = createFit(t, people)
  %CREATEFIT(T,PEOPLE)
  %  Create a fit.
  %
  %  Data for 'Number of  reported results' fit:
  %      X Input: t
  %      Y Output: people
  %  Output:
  %      fitresult : a fit object representing the fit.
  %      gof : structure with goodness-of fit info.
  %  Auto-generated by MATLAB on 19-Feb-2023 21:45:43
  %% Fit: 'Number of  reported results'.
  [xData, yData] = prepareCurveData( t, people );

  % Set up fittype and options.
  ft = fittype( 'gauss2' );
  opts = fitoptions( 'Method', 'NonlinearLeastSquares' );
  opts.Display = 'Off';
  opts.Lower = [-Inf -Inf 0 -Inf -Inf 0];
  opts.StartPoint = [361908 1 28.2178133341758 153789.112901742 42 37.6745879997992];

  % Fit model to data.
  [fitresult, gof] = fit( xData, yData, ft, opts );

  % Plot fit with data.
  figure( 'Name', 'Number of  reported results' );
  h = plot( fitresult, xData, yData );
  legend( h, 'people vs. t', 'Number of  reported results', 'Location', 'NorthEast', 'Interpreter', 'none' );
  % Label axes
  xlabel( 't', 'Interpreter', 'none' );
  ylabel( 'people', 'Interpreter', 'none' );
  grid on

  ```

  ![img](./images/Gaussian_fit_matlab.png)

## 1.4 Distance correlation

```python
from scipy.spatial.distance import pdist, squareform
import numpy as np
import openpyxl


def dist_correlation(X, Y):
    X = np.atleast_1d(X)
    Y = np.atleast_1d(Y)
    if np.prod(X.shape) == len(X):
        X = X[:, None]
    if np.prod(Y.shape) == len(Y):
        Y = Y[:, None]
    X = np.atleast_2d(X)
    Y = np.atleast_2d(Y)
    n = X.shape[0]
    if Y.shape[0] != X.shape[0]:
        raise ValueError('Number of samples must match')
    a = squareform(pdist(X))
    b = squareform(pdist(Y))
    A = a - a.mean(axis=0)[None, :] - a.mean(axis=1)[:, None] + a.mean()
    B = b - b.mean(axis=0)[None, :] - b.mean(axis=1)[:, None] + b.mean()

    dcov2_xy = (A * B).sum() / float(n * n)
    dcov2_xx = (A * A).sum() / float(n * n)
    dcov2_yy = (B * B).sum() / float(n * n)
    dcor = np.sqrt(dcov2_xy) / np.sqrt(np.sqrt(dcov2_xx) * np.sqrt(dcov2_yy))
    return dcor


if __name__ == '__main__':
    wb = openpyxl.load_workbook('E:/Git/mcm/mcm/wordle_data.xlsx')
    sheet = wb.active

    feq_list = []
    ratio_list = []

    for i in range(3, 362):
        feq_list.append(sheet['P'+str(i)].value)
        ratio_list.append(sheet['F'+str(i)].value / sheet['E'+str(i)].value)

    feq_arr = np.array(feq_list, dtype='float16')
    ratio_arr = np.array(ratio_list, dtype='float16')

    print(dist_correlation(feq_arr, ratio_arr))
```
